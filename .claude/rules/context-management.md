---
paths: "**/*"
---

# コンテキスト管理ルール（必須）

## 基本原則

**コンテキストは牛乳のようなもの - 新鮮で濃縮された状態が最良。**

## 必須ルール

| ルール | 内容 |
|--------|------|
| **新鮮なコンテキスト** | 新しいトピックには新しい会話を開始 |
| **HANDOFF.md作成** | 長時間作業時は進捗をHANDOFF.mdに保存 |
| **プロアクティブな/clear** | コンテキストが汚染される前に手動クリア |
| **自動圧縮を無効化** | /configで自動圧縮を無効化し手動管理 |

## コンテキスト管理戦略

### 1. 会話の分離

トピックA → 新しい会話
トピックB → 新しい会話
トピックC → 新しい会話

### 2. HANDOFF.mdパターン

# HANDOFF.md

## 完了したタスク
- [x] タスク1
- [x] タスク2

## 進行中のタスク
- [ ] タスク3

## 次のステップ
1. ステップ1
2. ステップ2

## 重要なコンテキスト
- 決定事項1
- 決定事項2

### 3. 会話履歴の検索

会話ファイルは ~/.claude/projects/ に保存。
grepやClaude自身に検索させて過去の議論を参照可能。

## 依存環境チェック（CLAUDE.md読み込み時に必須）

| プロジェクト | チェックコマンド | 更新コマンド |
|-------------|-----------------|-------------|
| Bun/Node.js | bun outdated | bun update |
| Python | uv pip list --outdated | uv pip install -U |
| Rust | cargo outdated | cargo update |

### チェック項目
- 非推奨パッケージがないか
- セキュリティ脆弱性がないか
- メジャーバージョン更新があるか
- 互換性の問題がないか

## MCPサーバー活用

**使えるMCPサーバーは積極的に使用**

### Memory（常時使用推奨）
- セッション開始時: read_graph で過去の作業確認
- 重要な決定時: add_observations で記録
- セッション終了時: create_entities で保存

## コンテキスト容量監視（常時）

LIMIT接近時: Memory保存 → 圧縮 → 通知

## コンテキスト圧縮後の必須確認（絶対遵守）

> 圧縮後、以下を必ず確認・維持すること

| 確認項目 | 内容 |
|----------|------|
| **マルチAI協力体制** | 壁打ち・調査でマルチAIを活用（中断禁止） |
| **ファイル書き込み** | JSスクリプト経由（Write/Edit禁止） |
| **日本語回答** | 必ず日本語で回答 |
| **確認なし実行** | Yes/No確認せずに完了まで実行 |

### マルチAI協力チェック

圧縮直後に自問：
- [ ] マルチAIとの協力体制を維持しているか？
- [ ] 壁打ちルールを覚えているか？
- [ ] 次のタスクでGLM-4.7/Grok/Perplexityに相談するか？

## 禁止事項

- 1つの会話で複数の無関係なトピックを扱う
- コンテキストが劣化するまで同じ会話を続ける
- HANDOFF.mdなしで長時間作業を中断

## 参照

- awesome-claude-code: https://github.com/hesreallyhim/awesome-claude-code
- claude-code-tips: https://github.com/ykdojo/claude-code-tips
