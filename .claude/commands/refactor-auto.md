---
description: コードの問題を検出し自動リファクタリング
allowed-tools: Read, Edit, Glob, Grep, Bash(bun:*), Bash(bunx:*), mcp__context7__*
argument-hint: [ファイル/ディレクトリ]
---

コードの問題を自動検出し、リファクタリングを実行します。

## 実行内容

### 1. コード分析
- 複雑度の測定
- 重複コードの検出
- 非推奨パターンの検出
- 型の問題
- パフォーマンス問題

### 2. 改善提案
- 問題点をリストアップ
- 優先度を付与
- 改善コードを提示

### 3. 自動修正
- 安全な修正を自動適用
- 危険な修正は確認後に適用

## 検出項目

### コード品質
| 問題 | 検出 | 自動修正 |
|------|------|---------|
| 未使用インポート | ✅ | ✅ |
| 未使用変数 | ✅ | ✅ |
| 長すぎる関数 | ✅ | 提案 |
| 深いネスト | ✅ | 提案 |
| マジックナンバー | ✅ | 提案 |

### TypeScript
| 問題 | 検出 | 自動修正 |
|------|------|---------|
| any型 | ✅ | 提案 |
| 型アサーション乱用 | ✅ | 提案 |
| 非nullアサーション | ✅ | 提案 |

### React
| 問題 | 検出 | 自動修正 |
|------|------|---------|
| 不要な再レンダリング | ✅ | 提案 |
| useEffect依存配列 | ✅ | 提案 |
| key属性の問題 | ✅ | ✅ |

### Python
| 問題 | 検出 | 自動修正 |
|------|------|---------|
| 型ヒント欠落 | ✅ | 提案 |
| docstring欠落 | ✅ | 提案 |
| PEP8違反 | ✅ | ✅ |

## リファクタリングパターン

| パターン | 説明 |
|---------|------|
| Extract Function | 長い関数を分割 |
| Extract Variable | 複雑な式を変数に |
| Inline | 不要な抽象化を削除 |
| Rename | より分かりやすい名前に |
| Move | 適切な場所に移動 |

## オプション

| オプション | 説明 |
|-----------|------|
| `--dry-run` | 変更せずにプレビュー |
| `--auto` | 安全な修正を自動適用 |
| `--all` | すべての修正を適用（確認あり） |
| `--type` | 型の問題のみ |
| `--perf` | パフォーマンス問題のみ |

## 使用例

```bash
# ファイルを分析・修正
/refactor-auto src/utils/helpers.ts

# ディレクトリ全体
/refactor-auto src/components/

# プレビューのみ
/refactor-auto src/ --dry-run
```

$ARGUMENTS で対象を指定。

## 安全性

- **自動修正**: 動作に影響しない軽微な修正のみ
- **提案**: 動作に影響する可能性がある修正は確認後
- **バックアップ**: 大きな変更前にはバックアップ推奨
